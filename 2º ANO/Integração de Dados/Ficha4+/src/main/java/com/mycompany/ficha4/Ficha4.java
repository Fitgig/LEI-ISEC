/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 */

package com.mycompany.ficha4;

import java.io.IOException;
import java.util.ArrayList;
import net.sf.saxon.s9api.SaxonApiException;
import net.sf.saxon.s9api.XdmValue;
import net.sf.saxon.trans.XPathException;
import org.jdom2.Document;
import org.jdom2.Element;

/**
 *
 * @author Utilizador
 */
public class Ficha4 {

    public static void main(String[] args) throws IOException, SaxonApiException, XPathException {
        
        // FERNANDO PESSOA
        //String nome_completo = Wrappers.obtem_nome_completo("Fernando Pessoa");
        //System.out.println("Nome Encontrado: " + nome_completo + "\n");
        
        //String nacionalidade = Wrappers.obtem_nacionalidade("Fernando Pessoa");
        //System.out.println("Nacionalidade: " + nacionalidade + "\n");
        
        //String nascimento = Wrappers.obtem_dnascimento("Fernando Pessoa");
        //System.out.println("Nascimento: " + nascimento + "\n");
        
        //String fotografia = Wrappers.obtem_fotografia("Fernando Pessoa");
        //System.out.println("Fotografia: " + fotografia + "\n");
        
        //ArrayList ocupacoes = Wrappers.obtem_ocupacoes("Fernando Pessoa");
        //System.out.println("Ocupações: " + ocupacoes + "\n");
        
        // PAULO COELHO
        //String nome_completo1 = Wrappers.obtem_nome_completo("Paulo Coelho");
        //System.out.println("Nome Encontrado: " + nome_completo1 + "\n");
        
        //String nacionalidade1 = Wrappers.obtem_nacionalidade("Paulo Coelho");
        //System.out.println("Nacionalidade: " + nacionalidade1 + "\n");
        
        //String nascimento1 = Wrappers.obtem_dnascimento("Paulo Coelho");
        //System.out.println("Nascimento: " + nascimento1 + "\n");
        
        //String fotografia1 = Wrappers.obtem_fotografia("Paulo Coelho");
        //System.out.println("Fotografia: " + fotografia1 + "\n");
        
        //ArrayList ocupacoes1 = Wrappers.obtem_ocupacoes("Paulo Coelho");
        //System.out.println("Ocupações: " + ocupacoes1 + "\n");
    
        // JOSÉ SARAMAGO
        //String nome_completo2 = Wrappers.obtem_nome_completo("José Saramago");
        //System.out.println("Nome Encontrado: " + nome_completo2 + "\n");
        
        //String nacionalidade2 = Wrappers.obtem_nacionalidade("José Saramago");
        //System.out.println("Nacionalidade: " + nacionalidade2 + "\n");
        
        //String nascimento2 = Wrappers.obtem_dnascimento("José Saramago");
        //System.out.println("Nascimento: " + nascimento2 + "\n");
        
        //String fotografia2 = Wrappers.obtem_fotografia("José Saramago");
        //System.out.println("Fotografia: " + fotografia2 + "\n");
        
        //ArrayList ocupacoes2 = Wrappers.obtem_ocupacoes("José Saramago");
        //System.out.println("Ocupações: " + ocupacoes2 + "\n");
        
        // MÁRIO CESARINY
        //String nome_completo3 = Wrappers.obtem_nome_completo("Mário Cesariny");
        //System.out.println("Nome Encontrado: " + nome_completo3 + "\n");
        
        //String nacionalidade3 = Wrappers.obtem_nacionalidade("Mário Cesariny");
        //System.out.println("Nacionalidade: " + nacionalidade3 + "\n");
        
        //String nascimento3 = Wrappers.obtem_dnascimento("Mário Cesariny");
        //System.out.println("Nascimento: " + nascimento3 + "\n");
        
        //String fotografia3 = Wrappers.obtem_fotografia("Mário Cesariny");
        //System.out.println("Fotografia: " + fotografia3 + "\n");
        
        //ArrayList ocupacoes3 = Wrappers.obtem_ocupacoes("Mário Cesariny");
        //System.out.println("Ocupações: " + ocupacoes3 + "\n");
       
        // FUNÇÃO
        //Escritor esc = criaEscritor("Fernando Pessoa");
        //esc.imprime();
        
        //Cria Escritor
        //Escritor esc = criaEscritor("Fernando Pessoa");
        //Document doc = XMLJDomFunctions.lerDocumentoXML("escritores.xml");
        //doc = ModeloXML.adicionaEscritor(esc, doc);
        //XMLJDomFunctions.escreverDocumentoParaFicheiro(doc, "escritores.xml");
    
        //Escritor esc1 = criaEscritor("Mário Cesariny");
        //doc = ModeloXML.adicionaEscritor(esc1, doc);
        //XMLJDomFunctions.escreverDocumentoParaFicheiro(doc, "escritores.xml");
        
        //Escritor esc2 = criaEscritor("Paulo Coelho");
        //doc = ModeloXML.adicionaEscritor(esc2, doc);
        //XMLJDomFunctions.escreverDocumentoParaFicheiro(doc, "escritores.xml");
        
        //Escritor esc3 = criaEscritor("José Saramago");
        //doc = ModeloXML.adicionaEscritor(esc3, doc);
        //XMLJDomFunctions.escreverDocumentoParaFicheiro(doc, "escritores.xml");
        
        //doc = ModeloXML.removeEscritor("Saramago", doc);
        //if(doc!=null){
        //    XMLJDomFunctions.escreverDocumentoParaFicheiro(doc, "escritores.xml");
        //}
        
        //doc = ModeloXML.removeOcupacao("Fernando Pessoa", "tradutor", doc);
        //if(doc!=null){
        //    XMLJDomFunctions.escreverDocumentoParaFicheiro(doc, "escritores.xml");
        //}
        
        //doc = ModeloXML.alteraNacionalidade("Fernando Pessoa", "Inglês", doc);
        //if(doc!=null){
            //XMLJDomFunctions.escreverDocumentoParaFicheiro(doc, "escritores.xml");
        //}
        
        //JFrame app = new JFrame();
        //app.setVisible(true);
        
        // FICHA 9
        
        //SaxonFunctions_XQuery.xQueryToText("escritores1.txt", "query1.xql");
        //SaxonFunctions_XQuery.xQueryToHtml("escritores2.html", "query2.xql");
        
        //String nome = "Fernando Pessoa";
        //Element raiz = new Element("input");
        //Document docV = new Document(raiz);
        //raiz.addContent(nome);
        //XMLJDomFunctions.escreverDocumentoParaFicheiro(docV, "input.xml");
        
        //SaxonFunctions_XQuery.xQueryToHtml("escritores2a.html", "query2a.xql");
        
        //SaxonFunctions_XQuery.xQueryToXml("escritores3.xml", "query3.xql");
        
        //String nome = "Fernando Pessoa";
        //Element raiz = new Element("input");
        //Document docV = new Document(raiz);
        //raiz.addContent(nome);
        //XMLJDomFunctions.escreverDocumentoParaFicheiro(docV, "input.xml");
        //SaxonFunctions_XQuery.xQueryToXml("escritores3.xml", "query4.xql");
        
        //SaxonFunctions_XQuery.xQueryToHtml("tabela.html", "query5.xql");
        
        SaxonFunctions_XQuery.xQueryToXml("escritores6.xml", "query6.xql");
        // --------------------------------------------------------------------
        
        //String xp = "//escritor[matches(nacionalidade, 'português', 'i')]/@nome";
        //XdmValue res = XPathFunctions.executaXpath(xp, "escritores.xml");
        
        //String s = XPathFunctions.listaResultado(res);
        //if (res==null)
        //    System.out.println("Ficheiro XML não existe");
        //else if (res.size() == 0)
        //    System.out.println("Sem resultados");
        //else
        //    System.out.println(s);
    }
    
    public static Escritor criaEscritor (String escritor) throws IOException, SaxonApiException{
        String xp = "//escritor[@nome='" + escritor+ "']";
        XdmValue res = null;
        res = XPathFunctions.executaXpath(xp, "escritores.xml");
        if (res == null || res.size() == 0) { //Escritor não existe
            String nome = Wrappers.obtem_nome_completo(escritor);
            String nacionalidade = Wrappers.obtem_nacionalidade(escritor);
            String nascimento = Wrappers.obtem_dnascimento(escritor);
            String fotografia = Wrappers.obtem_fotografia(escritor);
            ArrayList ocupacoes = Wrappers.obtem_ocupacoes(escritor);
        
            if(ocupacoes.isEmpty()){
                ocupacoes = Wrappers.obtem_ocupacoes2(escritor);
            }
            Escritor novo = new Escritor(escritor, nome, nacionalidade, nascimento, fotografia, ocupacoes);
        
            return novo;  
        }
        
        return null;
    } 
}
