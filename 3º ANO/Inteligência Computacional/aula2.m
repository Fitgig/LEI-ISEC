% AULA 2 (IC - 3º ANO)

% hyper-parâmetro: configuração.

% 35 entradas
% 10 saídas
% 1 label - digítos de 0 a 9

% Exercicío 1

% ALÍNEA A)

% cinco1 = [1 1 1 1 1 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 1 1 1 1 ...
%           0 0 0 0 1 ...
%           0 0 0 0 1 ...
%           1 1 1 1 1];
% 
% cinco2 = [0 1 1 1 1 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 1 1 1 1 ...
%           0 0 0 0 1 ...
%           0 0 0 0 1 ...
%           1 1 1 1 0];
% 
% cinco3 = [0 1 1 1 1 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           0 1 1 1 0 ...
%           0 0 0 0 1 ...
%           0 0 0 0 1 ...
%           1 1 1 1 0];
% 
% cinco4 = [1 1 1 1 0 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 1 1 1 1 ...
%           0 0 0 0 1 ...
%           0 0 0 0 1 ...
%           0 1 1 1 1];
% 
% cinco5 = [1 1 1 1 1 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 1 1 1 1 ...
%           0 0 0 0 1 ...
%           0 1 1 1 1];
% 
% cinco6 = [0 1 1 1 1 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 1 1 1 1 ...
%           0 0 0 0 1 ...
%           1 1 1 1 0];
% 
% cinco7 = [0 1 1 1 1 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           0 1 1 1 0 ...
%           0 0 0 0 1 ...
%           1 1 1 1 0];
% 
% cinco8 = [1 1 1 1 0 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 1 1 1 1 ...
%           0 0 0 0 1 ...
%           0 1 1 1 1];
% 
% cinco9 = [0 1 1 1 0 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           1 0 0 0 0 ...
%           0 1 1 1 0 ...
%           0 0 0 0 1 ...
%           0 1 1 1 0];
% 
% cinco10 = [1 1 1 1 1 ...
%            1 0 0 0 0 ...
%            1 0 0 0 0 ...
%            1 0 0 0 0 ...
%            0 1 1 1 0 ...
%            0 0 0 0 1 ...
%            1 1 1 1 1];
% 
% zero1 = [1 1 1 1 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 1 1 1 1];
% 
% zero2 = [0 1 1 1 0 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          0 1 1 1 0];
% 
% um1 = [1 1 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        1 1 1 1 1]; 
% 
% um2 = [0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0 ...
%        0 0 1 0 0];
% 
% dois1 = [1 1 1 1 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          1 1 1 1 1 ...
%          1 0 0 0 0 ...
%          1 0 0 0 0 ...
%          1 1 1 1 1];
% 
% dois2 = [1 1 1 1 0 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 1 1 1 0 ...
%          1 0 0 0 0 ...
%          1 0 0 0 0 ...
%          0 1 1 1 1];
% 
% tres1 = [1 1 1 1 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          1 1 1 1 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          1 1 1 1 1];
% 
% tres2 = [1 1 1 1 0 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          1 1 1 1 0 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          1 1 1 1 0];
% 
% quatro1 = [1 0 0 0 1 ...
%            1 0 0 0 1 ...
%            1 0 0 0 1 ...
%            1 1 1 1 1 ...
%            0 0 0 0 1 ...
%            0 0 0 0 1 ...
%            0 0 0 0 1];
% 
% quatro2 = [1 0 0 0 1 ...
%            1 0 0 0 1 ...
%            1 0 0 0 1 ...
%            0 1 1 1 1 ...
%            0 0 0 0 1 ...
%            0 0 0 0 1 ...
%            0 0 0 0 1];
% 
% seis1 = [1 0 0 0 0 ...
%          1 0 0 0 0 ...
%          1 0 0 0 0 ...
%          1 1 1 1 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 1 1 1 1];
% 
% seis2 = [0 1 1 1 1 ...
%          1 0 0 0 0 ...
%          1 0 0 0 0 ...
%          1 1 1 1 0 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 1 1 1 0];
% 
% sete1 = [1 1 1 1 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1];
% 
% sete2 = [1 1 1 1 0 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1];
% 
% oito1 = [1 1 1 1 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 1 1 1 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 1 1 1 1];
% 
% oito2 = [0 1 1 1 0 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          0 1 1 1 0 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          0 1 1 1 0];
% 
% nove1 = [1 1 1 1 1 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          1 1 1 1 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1];
% 
% 
% nove2 = [0 1 1 1 0 ...
%          1 0 0 0 1 ...
%          1 0 0 0 1 ...
%          0 1 1 1 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1 ...
%          0 0 0 0 1];
% 
% 
% % CONFIGURAÇÃO DA REDE.
% 
% P = [zero1; zero2; um1; um2; dois1; dois2; tres1; tres2; quatro1; quatro2;...
%      seis1; seis2; sete1; sete2; oito1; oito2; nove1; nove2;...
%      cinco1; cinco2; cinco3; cinco4; cinco5; cinco6; cinco7; cinco8; cinco9; cinco10]'; % 28
% 
% T = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1]; % 28
% 
% net = patternnet(50);
% net = train(net, P, T);
% 
% view(net);
% 
% y = round(net(P));
% perf = perform(net, T, y);
% 
% % ALÍNEA B)
% 
% Pteste = [zero1; zero2; ...
%           um1; um2; ...
%           dois1; dois2; ...
%           tres1; tres2; ...
%           quatro1; quatro2; ...
%           cinco1; cinco2; cinco3; cinco4; cinco5; cinco6; cinco7; cinco8; cinco9; cinco10; ...
%           seis1; seis2; ...
%           sete1; sete2; ...
%           oito1; oito2; ...
%           nove1; nove2;]';     
% 
% %plot digits
% 
% drawDigits = 1; 
% if drawDigits==1
%     for k=1:size(P,2)
%         d1=[];
%         for i=0:6
%             d=[];
%             for j=1:5
%                 d = [d P(i*5+j,k)];
%             end
%         d1 = [d1;d];
%         end
%         colormap(gray)
%         image(100*d1)
%         pause
%     end
% end

% EXERCICÍO 2

% Para a matriz de confusão:
% linha = precision;
% coluna = recall.

% LOAD TRAINING DATA SET.
Dadostreino = load('optdigits.tra');

% DEFINE INPUTS AND TARGETS FOR THE NN MODEL. 
x = Dadostreino(:, 1:64)';
targets = Dadostreino(:, 65)';

% ONE HOT ENCODING.
t = full(ind2vec(targets + 1));

net = patternnet(75);
net = train(net, x, t);

view(net);
y = net(x);
perf = perform(net, t, y);
classes = vec2ind(y);
plotconfusion(t, y);

% SAVE NET.
save myNet net